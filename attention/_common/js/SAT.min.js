/*! SAT.js - Version 0.2 - Copyright 2013 - Jim Riecken <jimr@jimr.ca> - released under the MIT License. https://github.com/jriecken/sat-js */
function v(){function c(b,d){this.x=b||0;this.y=d||0}function m(b,d){this.pos=b||new c;this.points=d||[];this.recalc()}function y(b,d,a){this.pos=b||new c;this.w=d||0;this.h=a||0}function w(){this.b=this.a=null;this.overlapN=new c;this.overlapV=new c;this.clear()}function z(b,d,a){for(var k=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=b.length,e=0;e<h;e++){var f=b[e].c(d);f<k&&(k=f);f>c&&(c=f)}a[0]=k;a[1]=c}function A(b,d,a,k,c,h){var l=q.pop(),f=q.pop();b=e.pop().copy(d).sub(b);d=b.c(c);z(a,c,l);z(k,c,
f);f[0]+=d;f[1]+=d;if(l[0]>f[1]||f[0]>l[1])return e.push(b),q.push(l),q.push(f),!0;h&&(a=0,l[0]<f[0]?(h.aInB=!1,l[1]<f[1]?(a=l[1]-f[0],h.bInA=!1):(a=l[1]-f[0],k=f[1]-l[0],a=a<k?a:-k)):(h.bInA=!1,l[1]>f[1]?(a=l[0]-f[1],h.aInB=!1):(a=l[1]-f[0],k=f[1]-l[0],a=a<k?a:-k)),k=Math.abs(a),k<h.overlap&&(h.overlap=k,h.overlapN.copy(c),0>a&&h.overlapN.reverse()));e.push(b);q.push(l);q.push(f);return!1}function x(b,d){var a=b.d(),c=d.c(b);return 0>c?-1:c>a?1:0}function B(b,d,a){for(var c=e.pop().copy(d.pos).sub(b.pos),
t=d.r,h=t*t,l=b.points,f=l.length,g=e.pop(),p=e.pop(),m=0;m<f;m++){var s=m===f-1?0:m+1,q=0===m?f-1:m-1,u=0,r=null;g.copy(b.edges[m]);p.copy(c).sub(l[m]);a&&p.d()>h&&(a.aInB=!1);var n=x(g,p);if(-1===n){g.copy(b.edges[q]);s=e.pop().copy(c).sub(l[q]);n=x(g,s);if(1===n){n=p.e();if(n>t)return e.push(c),e.push(g),e.push(p),e.push(s),!1;a&&(a.bInA=!1,r=p.normalize(),u=t-n)}e.push(s)}else if(1===n){if(g.copy(b.edges[s]),p.copy(c).sub(l[s]),n=x(g,p),-1===n){n=p.e();if(n>t)return e.push(c),e.push(g),e.push(p),
!1;a&&(a.bInA=!1,r=p.normalize(),u=t-n)}}else{s=g.f().normalize();n=p.c(s);q=Math.abs(n);if(0<n&&q>t)return e.push(c),e.push(s),e.push(p),!1;a&&(r=s,u=t-n,0<=n||u<2*t)&&(a.bInA=!1)}r&&a&&Math.abs(u)<Math.abs(a.overlap)&&(a.overlap=u,a.overlapN.copy(r))}a&&(a.a=b,a.b=d,a.overlapV.copy(a.overlapN).scale(a.overlap));e.push(c);e.push(g);e.push(p);return!0}var g={};g.Vector=c;g.V=c;c.prototype.copy=c.prototype.copy=function(b){this.x=b.x;this.y=b.y;return this};c.prototype.perp=c.prototype.f=function(){var b=
this.x;this.x=this.y;this.y=-b;return this};c.prototype.rotate=c.prototype.rotate=function(b){var d=this.x,a=this.y;this.x=d*Math.cos(b)-a*Math.sin(b);this.y=d*Math.sin(b)+a*Math.cos(b);return this};c.prototype.reverse=c.prototype.reverse=function(){this.x=-this.x;this.y=-this.y;return this};c.prototype.normalize=c.prototype.normalize=function(){var b=this.e();0<b&&(this.x/=b,this.y/=b);return this};c.prototype.add=c.prototype.add=function(b){this.x+=b.x;this.y+=b.y;return this};c.prototype.sub=c.prototype.sub=
function(b){this.x-=b.x;this.y-=b.y;return this};c.prototype.scale=c.prototype.scale=function(b,d){this.x*=b;this.y*=d||b;return this};c.prototype.project=c.prototype.g=function(b){var d=this.c(b)/b.d();this.x=d*b.x;this.y=d*b.y;return this};c.prototype.projectN=c.prototype.i=function(b){var d=this.c(b);this.x=d*b.x;this.y=d*b.y;return this};c.prototype.reflect=function(b){var d=this.x,a=this.y;this.g(b).scale(2);this.x-=d;this.y-=a;return this};c.prototype.reflectN=function(b){var d=this.x,a=this.y;
this.i(b).scale(2);this.x-=d;this.y-=a;return this};c.prototype.dot=c.prototype.c=function(b){return this.x*b.x+this.y*b.y};c.prototype.len2=c.prototype.d=function(){return this.c(this)};c.prototype.len=c.prototype.e=function(){return Math.sqrt(this.d())};g.Circle=function(b,d){this.pos=b||new c;this.r=d||0};g.Polygon=m;m.prototype.recalc=m.prototype.recalc=function(){this.edges=[];this.normals=[];for(var b=this.points,d=b.length,a=0;a<d;a++){var k=b[a],k=(new c).copy(a<d-1?b[a+1]:b[0]).sub(k),e=
(new c).copy(k).f().normalize();this.edges.push(k);this.normals.push(e)}return this};m.prototype.rotate=m.prototype.rotate=function(b){var d,a=this.points,c=this.edges,e=this.normals,h=a.length;for(d=0;d<h;d++)a[d].rotate(b),c[d].rotate(b),e[d].rotate(b);return this};m.prototype.translate=m.prototype.translate=function(b,d){var a,c=this.points,e=c.length;for(a=0;a<e;a++)c[a].x+=b,c[a].y+=d;return this};g.Box=y;y.prototype.toPolygon=function(){var b=this.pos,d=this.w,a=this.h;return new m(new c(b.x,
b.y),[new c,new c(d,0),new c(d,a),new c(0,a)])};g.Response=w;w.prototype.clear=w.prototype.clear=function(){this.bInA=this.aInB=!0;this.overlap=Number.MAX_VALUE;return this};for(var e=[],r=0;10>r;r++)e.push(new c);for(var q=[],r=0;5>r;r++)q.push([]);g.testCircleCircle=function(b,c,a){var k=e.pop().copy(c.pos).sub(b.pos),g=b.r+c.r,h=k.d();if(h>g*g)return e.push(k),!1;a&&(h=Math.sqrt(h),a.a=b,a.b=c,a.overlap=g-h,a.overlapN.copy(k.normalize()),a.overlapV.copy(k).scale(a.overlap),a.aInB=b.r<=c.r&&h<=
c.r-b.r,a.bInA=c.r<=b.r&&h<=b.r-c.r);e.push(k);return!0};g.testPolygonCircle=B;g.testCirclePolygon=function(b,c,a){if((b=B(c,b,a))&&a){c=a.a;var e=a.aInB;a.overlapN.reverse();a.overlapV.reverse();a.a=a.b;a.b=c;a.aInB=a.bInA;a.bInA=e}return b};g.testPolygonPolygon=function(b,c,a){for(var e=b.points,g=e.length,h=c.points,l=h.length,f=0;f<g;f++)if(A(b.pos,c.pos,e,h,b.normals[f],a))return!1;for(f=0;f<l;f++)if(A(b.pos,c.pos,e,h,c.normals[f],a))return!1;a&&(a.a=b,a.b=c,a.overlapV.copy(a.overlapN).scale(a.overlap));
return!0};return g}"function"===typeof define&&define.amd?define(v):"object"===typeof exports?module.exports=v():this.SAT=v();